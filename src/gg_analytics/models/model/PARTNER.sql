with
CTE_PARTNERS_SOURCE as (
  select *
  from {{ gg_ref('GG_PARTNERS', enable_mock=false) }}
)

, CTE_SALES_CONTACTS_SOURCE as (
  select *
  from {{ gg_ref('SALES_CONTACT', enable_mock=false) }}
)

, CTE_PARTNER as (
    select
    P.PARTNER_ID
    , P.PARTNER_TYPE
    , SC.SALES_CONTACT_ID as PARTNER_SALES_CONTACT_ID
    , SC.SALES_CONTACT_COUNTRY_CODE as PARTNER_SALES_CONTACT_COUNTRY_CODE
    , P.PARTNER_SALES_CONTACT_NAME
    , P.CREATED_AT_DATE_TIME
    , P.UPDATED_AT_DATE_TIME
  from CTE_PARTNERS_SOURCE as P
  left join CTE_SALES_CONTACTS_SOURCE as SC
  on P.PARTNER_SALES_CONTACT_NAME = SC.SALES_CONTACT_NAME
)

, CTE_FINAL as (
  select
    PARTNER_ID
    , PARTNER_TYPE
    {# , PARTNER_STATUS #}
    , PARTNER_SALES_CONTACT_ID
    , PARTNER_SALES_CONTACT_COUNTRY_CODE
    , PARTNER_SALES_CONTACT_NAME
    , CREATED_AT_DATE_TIME
    , UPDATED_AT_DATE_TIME
  from CTE_PARTNER
)

select *
from CTE_FINAL